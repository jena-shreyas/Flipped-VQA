| distributed init (rank 0): env://, gpu 0
[00:21:06.300408] job dir: /scratch/jenas/BTP/Flipped-VQA
[00:21:06.300620] Namespace(accum_iter=1,
adapter_layer=32,
adapter_len=10,
batch_size=2,
bias=3.5,
blr=0.09,
dataset='causalvidqa',
device='cuda',
dist_backend='nccl',
dist_on_itp=False,
dist_url='env://',
distributed=True,
epochs=5,
gpu=0,
llama_model_path='./pretrained/llama/',
local_rank=-1,
lr=None,
max_feats=10,
max_seq_len=256,
min_lr=0.0,
model='7B',
num_workers=0,
output_dir='./checkpoint/causalvidqa',
pin_mem=False,
qav=True,
rank=0,
resume='',
seed=0,
start_epoch=0,
sub=False,
tau=100.0,
vaq=True,
warmup_epochs=2,
weight_decay=0.14,
world_size=1)
[00:21:11.403423] Num train data: 500
[00:21:12.622065] Num val data: 500
[00:21:13.003450] Using model: 7B
[00:21:13.004785] loading from pretrained/llama/7B/consolidated.00.pth
[00:23:27.018880] base lr: 9.00e-02
[00:23:27.019025] actual lr: 7.03e-04
[00:23:27.019077] accumulate grad iterations: 1
[00:23:27.019123] effective batch size: 2
[00:23:27.167310] AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.95)
    eps: 1e-08
    lr: 0.000703125
    weight_decay: 0.0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.95)
    eps: 1e-08
    lr: 0.000703125
    weight_decay: 0.14
)
[00:23:27.167543] Start training for 5 epochs
[00:23:28.706040] Epoch: [0]  [  0/250]  eta: 0:06:18  lr: 0.000000  loss: 6.5002 (6.5002)  vqa_loss: 2.1816 (2.1816)  vaq_loss: 1.9932 (1.9932)  qav_loss: 2.3244 (2.3244)  time: 1.5135  data: 0.1745  max mem: 26573
[00:24:22.651056] Epoch: [0]  [ 62/250]  eta: 0:02:45  lr: 0.000087  loss: 5.0097 (5.3826)  vqa_loss: 1.5771 (1.7679)  vaq_loss: 1.3066 (1.3760)  qav_loss: 2.1813 (2.2387)  time: 0.8683  data: 0.0097  max mem: 26621
[00:25:16.829898] Epoch: [0]  [124/250]  eta: 0:01:50  lr: 0.000174  loss: 3.8008 (4.7961)  vqa_loss: 0.5947 (1.3463)  vaq_loss: 1.0391 (1.3071)  qav_loss: 2.0131 (2.1426)  time: 0.8676  data: 0.0088  max mem: 26621
[00:26:11.337119] Epoch: [0]  [186/250]  eta: 0:00:56  lr: 0.000262  loss: 3.4483 (4.3200)  vqa_loss: 0.4055 (1.0474)  vaq_loss: 1.0283 (1.2071)  qav_loss: 1.8789 (2.0655)  time: 0.8772  data: 0.0087  max mem: 26621
[00:27:05.227197] Epoch: [0]  [248/250]  eta: 0:00:01  lr: 0.000349  loss: 2.9186 (4.0302)  vqa_loss: 0.3772 (0.8862)  vaq_loss: 0.9653 (1.1669)  qav_loss: 1.6931 (1.9770)  time: 0.8788  data: 0.0105  max mem: 26621
[00:27:06.111595] Epoch: [0]  [249/250]  eta: 0:00:00  lr: 0.000350  loss: 2.8909 (4.0256)  vqa_loss: 0.3772 (0.8842)  vaq_loss: 0.9580 (1.1650)  qav_loss: 1.7056 (1.9763)  time: 0.8795  data: 0.0105  max mem: 26621
[00:27:06.111918] Epoch: [0] Total time: 0:03:38 (0.8757 s / it)
[00:27:06.118006] Averaged stats: lr: 0.000350  loss: 2.8909 (4.0256)  vqa_loss: 0.3772 (0.8842)  vaq_loss: 0.9580 (1.1650)  qav_loss: 1.7056 (1.9763)
[00:27:06.698983] Epoch: [0]  [  0/250]  eta: 0:02:21  lr: 0.000350  acc: 0.5000 (0.5000)  time: 0.5666  data: 0.0147  max mem: 26621
[00:27:41.124205] Epoch: [0]  [ 62/250]  eta: 0:01:44  lr: 0.000350  acc: 0.5000 (0.3333)  time: 0.5559  data: 0.0126  max mem: 26621
[00:27:46.866479] max sequence length overflow
[00:27:46.866687] max sequence length overflow
[00:27:46.866755] max sequence length overflow
[00:27:46.866823] max sequence length overflow
[00:27:46.866885] max sequence length overflow
[00:27:46.866977] max sequence length overflow
[00:27:46.867042] max sequence length overflow
[00:27:46.867100] max sequence length overflow
[00:27:46.867159] max sequence length overflow
[00:27:46.867215] max sequence length overflow
[00:27:46.867301] max sequence length overflow
[00:27:46.867361] max sequence length overflow
[00:27:46.867421] max sequence length overflow
[00:27:46.867477] max sequence length overflow
[00:27:46.867536] max sequence length overflow
[00:28:10.652104] max sequence length overflow
[00:28:10.652411] max sequence length overflow
[00:28:10.652479] max sequence length overflow
[00:28:10.652540] max sequence length overflow
[00:28:10.652599] max sequence length overflow
[00:28:10.652692] max sequence length overflow
[00:28:10.652755] max sequence length overflow
[00:28:10.652843] max sequence length overflow
[00:28:10.652904] max sequence length overflow
[00:28:10.652960] max sequence length overflow
[00:28:10.653048] max sequence length overflow
[00:28:10.653109] max sequence length overflow
[00:28:10.653168] max sequence length overflow
[00:28:10.653225] max sequence length overflow
[00:28:10.653285] max sequence length overflow
[00:28:15.095630] Epoch: [0]  [124/250]  eta: 0:01:09  lr: 0.000350  acc: 0.0000 (0.3252)  time: 0.5289  data: 0.0132  max mem: 26621
[00:28:49.878413] Epoch: [0]  [186/250]  eta: 0:00:35  lr: 0.000350  acc: 0.0000 (0.3027)  time: 0.5543  data: 0.0110  max mem: 26621
[00:29:24.259022] Epoch: [0]  [248/250]  eta: 0:00:01  lr: 0.000350  acc: 0.0000 (0.2935)  time: 0.5541  data: 0.0104  max mem: 26621
[00:29:24.812775] Epoch: [0]  [249/250]  eta: 0:00:00  lr: 0.000350  acc: 0.0000 (0.2923)  time: 0.5540  data: 0.0104  max mem: 26621
[00:29:24.813010] Epoch: [0] Total time: 0:02:18 (0.5547 s / it)
[00:29:24.846467] Averaged stats: lr: 0.000350  acc: 0.0000 (0.2923)
[00:29:26.591392] Epoch: [1]  [  0/250]  eta: 0:04:28  lr: 0.000352  loss: 2.6714 (2.6714)  vqa_loss: 0.3352 (0.3352)  vaq_loss: 1.0049 (1.0049)  qav_loss: 1.3315 (1.3315)  time: 1.0748  data: 0.0322  max mem: 26621
[00:30:20.115928] Epoch: [1]  [ 62/250]  eta: 0:02:42  lr: 0.000439  loss: 2.4356 (2.7072)  vqa_loss: 0.3823 (0.3920)  vaq_loss: 0.7148 (0.9158)  qav_loss: 1.3067 (1.3994)  time: 0.8622  data: 0.0050  max mem: 26621
[00:31:14.308167] Epoch: [1]  [124/250]  eta: 0:01:49  lr: 0.000526  loss: 2.5972 (2.6345)  vqa_loss: 0.3987 (0.3855)  vaq_loss: 1.0234 (0.9075)  qav_loss: 1.3105 (1.3414)  time: 0.8810  data: 0.0064  max mem: 26621
[00:32:08.519115] Epoch: [1]  [186/250]  eta: 0:00:55  lr: 0.000613  loss: 2.4937 (2.5949)  vqa_loss: 0.3740 (0.3871)  vaq_loss: 1.1006 (0.9476)  qav_loss: 1.0923 (1.2603)  time: 0.8826  data: 0.0058  max mem: 26621
[00:33:02.484091] Epoch: [1]  [248/250]  eta: 0:00:01  lr: 0.000700  loss: 1.8683 (2.5130)  vqa_loss: 0.3936 (0.3901)  vaq_loss: 0.6592 (0.9494)  qav_loss: 0.7855 (1.1735)  time: 0.8605  data: 0.0048  max mem: 26621
[00:33:03.348456] Epoch: [1]  [249/250]  eta: 0:00:00  lr: 0.000702  loss: 1.8683 (2.5091)  vqa_loss: 0.3936 (0.3903)  vaq_loss: 0.6592 (0.9460)  qav_loss: 0.7902 (1.1729)  time: 0.8608  data: 0.0048  max mem: 26621
[00:33:03.348736] Epoch: [1] Total time: 0:03:37 (0.8713 s / it)
[00:33:03.352703] Averaged stats: lr: 0.000702  loss: 1.8683 (2.5091)  vqa_loss: 0.3936 (0.3903)  vaq_loss: 0.6592 (0.9460)  qav_loss: 0.7902 (1.1729)
[00:33:03.914030] Epoch: [1]  [  0/250]  eta: 0:02:17  lr: 0.000702  acc: 0.5000 (0.5000)  time: 0.5493  data: 0.0110  max mem: 26621
[00:33:14.448831] max sequence length overflow
[00:33:14.449024] max sequence length overflow
[00:33:14.449102] max sequence length overflow
[00:33:14.449177] max sequence length overflow
[00:33:14.449248] max sequence length overflow
[00:33:14.449364] max sequence length overflow
[00:33:14.449446] max sequence length overflow
[00:33:14.449519] max sequence length overflow
[00:33:14.449590] max sequence length overflow
[00:33:14.449662] max sequence length overflow
[00:33:14.449762] max sequence length overflow
[00:33:14.449845] max sequence length overflow
[00:33:14.449919] max sequence length overflow
[00:33:14.449989] max sequence length overflow
[00:33:14.450062] max sequence length overflow
[00:33:38.295451] Epoch: [1]  [ 62/250]  eta: 0:01:44  lr: 0.000702  acc: 0.0000 (0.2903)  time: 0.5549  data: 0.0105  max mem: 26621
[00:33:41.071766] max sequence length overflow
[00:33:41.071928] max sequence length overflow
[00:33:41.071992] max sequence length overflow
[00:33:41.072054] max sequence length overflow
[00:33:41.072113] max sequence length overflow
[00:33:41.072205] max sequence length overflow
[00:33:41.072268] max sequence length overflow
[00:33:41.072329] max sequence length overflow
[00:33:41.072387] max sequence length overflow
[00:33:41.072448] max sequence length overflow
[00:33:41.072529] max sequence length overflow
[00:33:41.072592] max sequence length overflow
[00:33:41.072672] max sequence length overflow
[00:33:41.072732] max sequence length overflow
[00:33:41.072790] max sequence length overflow
[00:34:12.365284] Epoch: [1]  [124/250]  eta: 0:01:09  lr: 0.000702  acc: 0.0000 (0.3211)  time: 0.5550  data: 0.0112  max mem: 26621
[00:34:46.821310] Epoch: [1]  [186/250]  eta: 0:00:35  lr: 0.000702  acc: 0.0000 (0.3000)  time: 0.5562  data: 0.0112  max mem: 26621
[00:35:21.187317] Epoch: [1]  [248/250]  eta: 0:00:01  lr: 0.000702  acc: 0.0000 (0.3178)  time: 0.5535  data: 0.0104  max mem: 26621
[00:35:21.744001] Epoch: [1]  [249/250]  eta: 0:00:00  lr: 0.000702  acc: 0.0000 (0.3185)  time: 0.5536  data: 0.0104  max mem: 26621
[00:35:21.744237] Epoch: [1] Total time: 0:02:18 (0.5535 s / it)
[00:35:21.773938] Averaged stats: lr: 0.000702  acc: 0.0000 (0.3185)
[00:35:23.272323] Epoch: [2]  [  0/250]  eta: 0:04:43  lr: 0.000703  loss: 1.4973 (1.4973)  vqa_loss: 0.3628 (0.3628)  vaq_loss: 0.1802 (0.1802)  qav_loss: 0.9543 (0.9543)  time: 1.1358  data: 0.0651  max mem: 26621
[00:36:17.439134] Epoch: [2]  [ 62/250]  eta: 0:02:45  lr: 0.000691  loss: 1.7218 (1.7980)  vqa_loss: 0.3281 (0.3661)  vaq_loss: 0.6860 (0.7979)  qav_loss: 0.5412 (0.6341)  time: 0.8615  data: 0.0057  max mem: 26621
[00:37:12.105654] Epoch: [2]  [124/250]  eta: 0:01:50  lr: 0.000657  loss: 1.8218 (1.8019)  vqa_loss: 0.3689 (0.3531)  vaq_loss: 0.9668 (0.8613)  qav_loss: 0.5446 (0.5875)  time: 0.8823  data: 0.0088  max mem: 26621
[00:38:06.257580] Epoch: [2]  [186/250]  eta: 0:00:56  lr: 0.000602  loss: 1.3119 (1.7617)  vqa_loss: 0.3638 (0.3620)  vaq_loss: 0.6699 (0.8651)  qav_loss: 0.2993 (0.5347)  time: 0.8636  data: 0.0053  max mem: 26621
